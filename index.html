<!DOCTYPE html>
<html iang="ja">
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.1/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.7/dist/vuetify.min.css" rel="stylesheet">

    <title>webアプリ１（カウントアップ）</title>
  </head>
 
  <body>
    <div id="app">
     <v-app>

      <v-container fluid>
       <v-row
        class="blue lighten-4" style="height: 700px;"
        justify="center" align-content="center"
       >
        <v-col
         cols=12 sm=12 md=8 lg=4 xl=3
        >

         <v-card color="white" shaped>
          <p class="text-h1 text-center pink--text">{{count}}</p>
          <p class="text-h4 text-center">count number</p>
         </v-card>

         <v-card color="green" >
           <v-card-actions>
           <v-spacer></v-spacer>
           <v-btn height="100" width="100" rounded v-on:click="increment" class="text-h5">＋１</v-btn>
           <v-spacer></v-spacer>
           <v-btn height="100" width="100" rounded v-on:click="clear" dark class="text-h5">ＺＥＲＯ</v-btn>
           <v-spacer></v-spacer>
           </v-card-actions>
         </v-card>

         <v-card color="yellow" >
          <v-card-actions>
           <v-spacer></v-spacer>
           <v-btn height="100" width="100" outlined color="primary" v-on:click="output" class="text-h5">Update</v-btn>
           <v-spacer></v-spacer>
          </v-card-actions>
         </v-card>

        </v-col>
       </v-row>
      </v-container>
     </v-app>
    </div>
   
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.11/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.7/dist/vuetify.js"></script>
    <script >

      new Vue({
       el: '#app',
       vuetify: new Vuetify(),
       data: {
       count: ""
       },
       created: function(){
       google.script.run.
       withSuccessHandler(this.initData).getSheetData();
       },
       methods: {
       increment: function() {
         this.count += 1
         },
       clear: function() {
         this.count = 0
         },
       output: function() {
         google.script.run.setSheetData(this.count);
         },
       initData: function(ssData) {
         this.count = ssData;
       }
       }
      })
    </script>
  </body>
