<!DOCTYPE html>
<html iang="ja">
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <style>
     #counter{
      width: 100%;
      font-size: 64pt;
      text-align: center;
      background-color: #fa8072;
     }

     #btnAdd1,#btnReset{
      width: 100%;
      font-size: 32pt;
      text-align: center;
      background-color: yellow;
     }
    </style>
    <script >
      let num;
      // add ボタン押すと１加算
      function addCount(){
        num++;
        counter.innerHTML = num;
      }
      //  reset ボタン押すとZEROへ初期化
      function resetCount(){
        num = 0;
        counter.innerHTML = 0;
      }
      //★２－１追加★
      function output() {
      // 1. テキストボックスに入力した値を取得します。
        const value = document.getElementById('counter').innerHTML;
      // 2. 取得した値を setSheetData関数の引数として設定して呼び出します。
        google.script.run.setSheetData(value); 
      }

      window.addEventListener("load",()=>{
      // ２－２ スプレッドシートから値を取得、表示用する
      //　load時のzero初期化をやめ、スプレッドシートから取得した値を格納する
              num = <?= values ?>;
      //
        btnAdd1.addEventListener("click", addCount);
        btnReset.addEventListener("click", resetCount);

      })
    </script>
    <title>webアプリ１（カウントアップ）</title>
  </head>
  <body>
    <p id="counter"><?= values ?></p>
    <p><input type="button" id="btnAdd1" value="加算"></p>
    <p><input type="button" id="btnReset" value="最初から"></p>
    <input type="submit" id='submit' onclick='output()' />
  </body>
  