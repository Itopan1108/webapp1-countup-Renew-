//（ＤＢ接続 部分）

var connectionName = 'esm-gcp-study:us-central1:modern-study'; //Instance_connection_name
var userName = 'esm'; //user_name
var password = 'esm'; //'user_password'
var databaseName = 'web_counter_Itopan1108'; //database_name

var getData =  getDate()

var url = 'jdbc:google:mysql://' + connectionName + '/' + databaseName;


//（４－５ DBに値を更新する関数）

function updateOneRecord() {
  var connection = Jdbc.getCloudSqlConnection(url, userName, password);

  var statement = connection.prepareStatement('UPDATE countup SET count_number=?, updated_at=? WHERE entryID=1');
  statement.setString(1, count_number + 1);
  statement.setdate(2, getDate);

  var row = statement.executeUpdate();
  Logger.log(row);
 
  statement.close();
  connection.close();
}


//（４－６ DBから値を取得する関数）

function readFromTable() {
  var connection = Jdbc.getCloudSqlConnection(url, userName, password);
  var statement = connection.createStatement();
  var results = statement.executeQuery('SELECT * FROM countup');
 
  var entryID = results.getInt('id');
  var count_number = results.getInt('count_number');
   
  Logger.log(entryID, count_number);

  results.close();
  statement.close();
  connection.close();
}
